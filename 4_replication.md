동기적 복제
=
모든 서버에 변경을 한 후 클라이언트에 응답을 보내는 방식.
가장 느린 서버만큼의 속도가 소요되며, 네트워크 지연에 민감하다.

read-only일 때는 가능하지만, 업데이트 시에 노드간의 실패가 있는 경우에는 사용하기에 더 이상 진행되기가 어렵다. 이런 특성 때문에 클라이언트 입장에서는 작업의 완료 여부에 대해 강한 보장이 생긴다.

비동기적 복제
=
마스터는 클라이언트에 즉시 응답을 보내고 이후의 일을 비동기적으로 처리한다.

복제의 유형
=
1. 데이터 분화가 일어나지 않게하는 single-copy
2. 데이터 분화를 감안하는 multi-master

single-copy의 시스템의 경우 마치 하나의 서버인 것 처럼 행동하며 다음의 특징(합의)을 가진다.

1. 모든 올바른 프로세스는 같은 값에 동의해야 한다.
2. 모든 올바른 프로세스는 최대 한 가지 값을 골라야 한다.
3. 모든 프로세스는 결정을 해야한다.
4. 만약 올바른 모든 프로세스가 같은 값을 제안했다면, 모든 올바른 프로세스는 그 값으로 결정을 내려야한다.

primary/backup replication(master-slave replication)
=
가장 일반적으로 쓰이는 복제 방식 중 하나이다.
모든 업데이트 과정은 primary(master)에서 이루어지고 연산의 로그가 네트워크를 타고 backup(slave)으로 전파되는 방식이다.

동기적으로 이루어질 때는 두 가지 과정(업데이트 + 수신에 대한 응답)이 필요하고, 비동기적으로 처리할 때는 한 가지 과정(업데이트)만이 필요하다.

primary/backup replication은 기껏해야 완벽한 보장을 해주지는 못한다.
또 split-brain 현상을 일으키기 쉽다. 

2PC
=
2PC는 많은 관계형 DB에서 사용하는 프로토콜이다.
1. 일괄 업데이트
2. 피드백

모든 피드백이 커밋되었음을 알릴 때, 임시 저장에서 영구적인 저장으로 상태를 변경한다. 그렇기 때문에 노드가 실패했을 때 롤백할 가능성을 열어두고 있다.

하지만 2PC은 네트워크나 노드 간 통신과 같은 분할 내구성에는 별다른 대안이 되지 못한다.

2PC는 속도와 안정성 사이의 트레이드 오프 관계를 가진다.

분할 내구성을 가진 합의 알고리즘
=
네트워크 파티션이란 노드들 간의 네트워크가 실패하는 것을 의미한다. 

Paxos(다수결)
=
2PC가 모든 노드의 동의를 전제로 하는 반면, 다수결에 따른 합의를 도출하는 알고리즘이다.

분명한 다수결을 이루가 위해 홀수 갯수의 노드를 운영한다.
소수의 노드는 동작을 멈추고, 이에 따라 다수의 노드가 active한 상태로 남게 된다.

역할
=
모든 노드가 같은 책임을 가질 수도 있지만, 노드마다 다른 수준의 역할을 부여할 수도 있다.

복제에 사용하는 합의 알고리즘은 일반적으로 다른 역할을 부여하는 경우가 많다.

마스터 노드가 쓰기 연산에 최적화되어있는 경우를 예로 들 수 있다.



