분산 시스템을 만드는 것은 마치 하나가 동작하는 것과 같이 보이게하는 추상화의 밸런스를 다루는 일.

추상화라는 것은 결국 덜 중요한 부분을 쳐내고, 다루기 쉽게 만드는 것. 추상화의 본질은 fake이다. 진실과 멀어지지만, 다루기 쉬워진다.

시스템 모델
=
분산 시스템은 다음과 같은 특징을 가진다.

- 독립적인 노드 동시적으로 동작시키는 것. 
- 네트워크를 통해 연결되며, 공유하는 메모리나 시계 등이 없는 상태.(전역적 데이터는 outdated 되었을 가능성이 존재). 
- 각 노드 들은 실패에 대해 독립적인 회복이 가능해야 한다. 
- 메시지는 손실되거나 지연 될 수 있다.
- 시계는 동기화 되지 않는다.
  
**system model**

시스템 모델은 크게 다음과 같은 요소에 따라 다양한 가정을 한다.

- 노드가 실패한다면 무엇을 할 수 있는지?
- 커뮤니케이션 링크가 어떠게 동작하고 실패하는 지? 
- 시간, 순서보장과 같은 전반적인 요소가 어떤지?

견고한 시스템은 환경과 상황에 대해, 의심하고 적은 수준의 보장만을 가정한다. 이런 시스템은 다른 환경에 유연하다.

**node in our system model**

노드는 연산과 저장을 하는 호스트의 역할을 한다.
- 프로그램을 실행시킬 수 있다.
- 데이터를 인메모리와 persistent 저장소 안에 저장할 수 있다.
- 시간에 대한 개념이 있다.

crash-recovery model: 노드는 crash에 의해 실패하고, 이 포인트에서 얼마간 시간이 흐른 후 회복한다는 모델. (비교적 명시적인 모델, 또 안일한 모델)

byzantine fault tolerance: 모호함으로 인해 오류가 발생할 수 있다는 관점. (비교적 의심 많은 모델)

**communitcation links in our system model**
커뮤니케이션 링크는 개별 노드들을 이어준다. 또 양 방향에서 메시지가 오갈 수 있게 해준다.

네트워크 파티션은 노드가 실패한 것이 아닌 네트워크의 결함으로 발생하는 오류이다.

**timing / ordering assumptions**
분산 시스템의 끼다로운 문제 중 하나는 각각의 노드가 현실을 제각기의 방식으로 인식한다는 것.

동기식: 락을 건 채로 프로세스가 진행. 시간과 순서에 제약을 둔다. 데이터 전송 지연에 상한선이 있다. 
비동기식: 타이밍에 대한 예상이 불가능하다. 지연에 대한 상한선 역시 없다.

**합의 문제**

**The FLP impossiblity result**
비동기 모델에서의 합의문제를 다루는 방법이다.
노드는 crush에 의해서만 실패하며, 네트워크를 신뢰할 수 있다고 가정한다. 또 이 가정으로 인해 네트워크 딜레이에 대한 상한선도 있다고 가정한다.

이 경우 비동기 모델에서 한 노드가 실패할 경우, 단순하게 문제를 해결할 수 있는 알고리즘은 없다고 가정한다. 따라서 비동기 모델에서의 트레이드-오프 관계를 의미한다.

**The CAP theorem**

CAP 정리(CAP 定理), 또는 브루어의 정리(Brewer 定理)는 다음과 같은 세 가지 조건을 모두 만족하는 분산 컴퓨터 시스템이 존재하지 않음을 증명한 정리이다.

- 일관성(一貫性, Consistency): 모든 노드가 같은 순간에 같은 데이터를 볼 수 있다.
- 가용성(可用性, Availability): 모든 요청이 성공 또는 실패 결과를 반환할 수 있다.
- 분할내성(分割耐性, Partition tolerance): 메시지 전달이 실패하거나 시스템 일부가 망가져도 시스템이 계속 동작할 수 있다.

위의 세 가지 조건의 첫 글자를 따서 CAP 정리라고 부른다.

단, 일관성에 대한 정의를 강한 일관성이 아니라고 재정의하면 타협의 여지가 있다. 일관성을 그 어떤 종류의 보장이라도 재정의한다면 이 문제에 대해 더 논의를 할 수 있다.

**consistency model**

강한 일관성
- Lineariable
- Sequential

약한 일관성
- client-centric
- causal-consistency
- eventual-consistency

**강한 일관성**

Lineariable: 강력한 일관성 모델, 동시에 일어난 사건에 대해서 조차 순서를 매기는 방식.

Sequential: 분산 시스템에서의 상대적으로 약한 일관성 모델, 동시에 발생한 연산들 간의 순서를 반영하지 않는다.

**약한 일관성**
client-centric: 클라이언트의 컴퓨터에 캐싱하는 등의 방식으로, 만일 데이터를 레플리카로부터 가져오는 상황이 되더라도 싱크를 맞추고 최신 데이터를 보여주는 방식.

eventual-consistency: 
